<!DOCTYPE html>
<html>
<head>
	<script src="../lib/jquery-1.6.4.min.js"></script>
	
	<script src="../src/vorple.core.js"></script>
	<script src="../src/vorple.html.js"></script>
	<script src="../src/vorple.button.js"></script>
	<script type="text/javascript" src="lib/qunit-git.js"></script>
	
	<link rel="stylesheet" href="lib/qunit-git.css" type="text/css" media="screen" />

<script>

$(document).ready(function(){
    vorple.core.init();
    
    module( 'buttons' );
    
    test( 'basic', function() {
        var button = new vorple.button.template.Basic();
        ok(
            (function() { return vorple.html.$toHtml( button.element ).match(
                    /\<button class\=\"button_[0-9a-zA-Z]*\"\>\<\/button\>/ 
            ); } )(),
            'empty button'
        ); 

        button = new vorple.button.template.Basic( { text: 'Test', class: 'foo' } );
        ok(
            (function() { 
                return vorple.html.$toHtml( button.element )
                    .match( /\<button class\=\"foo button_[0-9a-zA-Z]*\"\>Test\<\/button\>/ ); } 
            )(),
			'text and class'
        );

        ok( button.isEnabled(), 'Created as enabled' );
        button.disable();
        ok( !button.isEnabled(), 'isEnabled is false after disable' );

        equal( 
            button.element.attr( 'disabled' ),
            'disabled',
            'disabling'
        );
        
    } );

    test( 'link', function() {
        var button = new vorple.button.template.Link();
        
        ok(
            (function() { return vorple.html.$toHtml( button.element ).match(
                    /\<span class\=\"button_[0-9a-zA-Z]*\"\>\<a href=\"#\"\>\<\/a\>\<\/span\>/ 
            ); } )(),
            'empty button'
        ); 

        button = new vorple.button.template.Link( { 
            text: 'Test', 
            class: 'foo', 
            url: 'bar',
            onclick: 'baz' 
        } );

        ok(
            (function() { 
                return vorple.html.$toHtml( button.element )
                    .match( /\<span class\=\"foo button_[0-9a-zA-Z]*\"\>\<a href=\"bar\"\ onclick=\"baz\">Test\<\/a\>\<\/span\>/ ); } 
            )(),
			'text and class'
        );

        ok( button.isEnabled(), 'Created as enabled' );
        button.disable();
        ok( !button.isEnabled(), 'isEnabled is false after disable' );

        equal(
            button.element.html(),
            'Test',
            'disabled link content'
        );

        ok(
            button.element.hasClass( 'ex_link' ),
            'disabled link has class ex_link'
        );
    } );

    test( 'image', function() {
        var button = new vorple.button.template.Image();
        ok(
            (function() { return vorple.html.$toHtml( button.element ).match(
                    /\<img src=\"\" class\=\"button_[0-9a-zA-Z]*\"\>/ 
            ); } )(),
            'empty image'
        ); 

        button = new vorple.button.template.Image( { src: 'test.jpg', class: 'foo' } );
        ok(
            (function() { 
                return vorple.html.$toHtml( button.element )
                    .match( /\<img src=\"test\.jpg\" class\=\"foo button_[0-9a-zA-Z]*\"\>/ ); } 
            )(),
			'text and class'
        );

        ok( button.isEnabled(), 'Created as enabled' );
        button.disable();
        ok( !button.isEnabled(), 'isEnabled is false after disable' );

        button = new vorple.button.template.Image( { src: 'test.jpg' }, { src: 'disabled.png' } );
        button.disable();

        equal(
            button.element.attr( 'src' ),
            'disabled.png',
            'disabled image changed'
        );
    } );


    module( 'button groups' );

    test( 'create', function() {
        var g = new vorple.button.Group();
        equal( g.html(), '<div></div>', 'group is empty' );
        ok( g.element.jquery, 'element is a jQuery object' );

        g = new vorple.button.Group( null, { id:'foo', class:'bar' });
        equal( g.element.attr( "id" ), 'foo', 'object container id' );
        ok( g.element.hasClass( 'bar' ), 'object container class' );

        g = new vorple.button.Group( null, '<ul>' );
        equal( g.html(), '<ul></ul>', 'container element specified as string' );

        g = new vorple.button.Group( '', { tag:'ul' } );
        equal( g.html(), '<ul></ul>', 'container element specified as tag' );  
        
        g = new vorple.button.Group( null, $( '<ul>' ) );
        equal( g.html(), '<ul></ul>', 'jquery object as container' );

        g = new vorple.button.Group( '<span>bar</span>' );
        equal( g.html(), '<div><span>bar</span></div>', 'string content' );

        g = new vorple.button.Group( [ '<span>bar</span>', '<span>baz</span>' ] );
        equal( g.html(), '<div><span>bar</span><span>baz</span></div>', 'string array content' );

        var button = new vorple.button.template.Basic();
        
        g = new vorple.button.Group( button );
        equal( g.html(), '<div>'+button.html()+'</div>', 'button content' );
        
        g = new vorple.button.Group( [ button, '<span>baz</span>' ] );
        equal( g.html(), '<div>'+button.html()+'<span>baz</span></div>', 'mixed array content' );

    } );
});
</script>
  
</head>
<body>
  <h1 id="qunit-header">Vorple button</h1>
 <h2 id="qunit-banner"></h2>
 <div id="qunit-testrunner-toolbar"></div>
 <h2 id="qunit-userAgent"></h2>
 <ol id="qunit-tests"></ol>
 <div id="qunit-fixture">test markup, will be hidden</div>
</body>
</html>
